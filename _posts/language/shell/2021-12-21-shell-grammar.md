---
layout: post
title: "Shellï¼šè¯­æ³•"
subtitle: "Shell Grammer Introduction"
date: 2021-12-21 17:45:38
author: "HapppyTsing"
catalog: false
header-style: text
tags:
  - Shell
---

# ä¸€ã€ç®€ä»‹

> â— æœ¬æ–‡åŸºäº bashï¼ŒåŒæ—¶ä¹Ÿä¼šè®¨è®ºä¸€äº› zsh çš„ç‰¹æ€§ï¼

- shellï¼šC è¯­è¨€ç¼–å†™çš„åº”ç”¨ç¨‹åºï¼Œæä¾›ä¸€ä¸ªç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¯¥ç•Œé¢è¾“å…¥å‘½ä»¤è®¿é—® Linux æœåŠ¡
- shell scriptï¼šä¸º shell ç¼–å†™çš„è„šæœ¬ç¨‹åºï¼Œæ–‡ä»¶åç¼€ä¸º `.sh`
- shell interpreterï¼šè„šæœ¬è§£é‡Šå™¨ï¼Œç§ç±»ä¼—å¤šï¼Œshã€bashã€zsh

# äºŒã€æŒ‡å®šè„šæœ¬è§£é‡Šå™¨

åœ¨ shell è„šæœ¬ï¼Œ`#!`Â  å‘Šè¯‰ç³»ç»Ÿå…¶åè·¯å¾„æ‰€æŒ‡å®šçš„ç¨‹åºå³æ˜¯è§£é‡Šæ­¤è„šæœ¬æ–‡ä»¶çš„ Shell è§£é‡Šå™¨ã€‚`#!`Â  è¢«ç§°ä½œ[shebangï¼ˆä¹Ÿç§°ä¸º Hashbang ï¼‰](https://zh.wikipedia.org/wiki/Shebang)ã€‚

å‡ºç°åœ¨ shell è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œæœ‰ä¸¤ç§å†™æ³•ï¼š

- ç›´æ¥æŒ‡å®šï¼š `#!/bin/sh` ã€ `#!/bin/bash`
- è‡ªåŠ¨æŒ‡å®šï¼š `#!/usr/bin/env bash`

> ğŸ’¡ å½“ä½¿ç”¨æ–¹æ³•äºŒè‡ªåŠ¨æŒ‡å®šæ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨åœ¨ PATH ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾ä½ æŒ‡å®šçš„ç¨‹åºï¼Œæ¨èä½¿ç”¨è¯¥å†™æ³•ï¼Œå› ä¸ºç¨‹åºçš„è·¯å¾„æ˜¯ä¸ç¡®å®šçš„ï¼Œè€Œä¸”ç›´æ¥æŒ‡å®šå¯èƒ½è¿˜ä¼šè®¾è®¡ shell ç‰ˆæœ¬çš„é—®é¢˜ï¼Œè€Œ PATH ä¸­çš„ç‰ˆæœ¬æ€»æ˜¯å½“å‰å¸Œæœ›ä½¿ç”¨çš„ã€‚

# ä¸‰ã€shell æ¨¡å¼

- äº¤äº’æ¨¡å¼ï¼šæ‰‹åŠ¨è¾“å…¥ä¸€äº›åˆ— Linux å‘½ä»¤ï¼Œæ¯”å¦‚ `ls` ã€ `cd` ç­‰
- éäº¤äº’æ¨¡å¼ï¼šå¯ä»¥ç†è§£ä¸ºæ‰§è¡Œ shell è„šæœ¬ï¼Œshell ä»æ–‡ä»¶æˆ–ç®¡é“ä¸­è¯»å–å‘½ä»¤å¹¶æ‰§è¡Œï¼Œå½“ shell è§£é‡Šå™¨æ‰§è¡Œå®Œæ–‡ä»¶ä¸­çš„æœ€åä¸€ä¸ªå‘½ä»¤ï¼Œshell è¿›ç¨‹ç»ˆæ­¢ï¼Œå¹¶å›åˆ°çˆ¶è¿›ç¨‹ã€‚
  - åœ¨æ–°è¿›ç¨‹ä¸­è¿è¡Œ shell è„šæœ¬
    - å°†è„šæœ¬ç¨‹åºä½œä¸º**å¯æ‰§è¡Œç¨‹åº**è¿è¡Œï¼š`./shell_script.sh` ï¼Œè¿™ç§æ–¹æ³•éœ€è¦å…ˆç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼š `chmod +x shell_script.sh`
    - å°† shell è„šæœ¬ä½œä¸ºå‚æ•°ä¼ é€’ç»™ shell è§£é‡Šå™¨ï¼š`bash shell_script.sh` ï¼Œè¿™ç§æ–¹æ³•ä¸éœ€è¦ç»™è„šæœ¬æ‰§è¡Œæƒé™ï¼Œä¹Ÿä¸éœ€è¦åœ¨è„šæœ¬æ–‡ä»¶çš„ç¬¬ä¸€è¡ŒæŒ‡å®šè„šæœ¬è§£é‡Šå™¨ï¼ŒæŒ‡å®šäº†ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚
  - åœ¨å½“å‰è¿›ç¨‹ä¸­è¿è¡Œ shell è„šæœ¬ï¼š`source shell_script.sh` ï¼Œè¿™ç§æ–¹æ³•ä¼šå¼ºåˆ¶æ‰§è¡Œè„šæœ¬æ–‡ä»¶ä¸­çš„å…¨éƒ¨å‘½ä»¤ï¼Œä¸éœ€è¦ç»™è„šæœ¬æ‰§è¡Œæ–‡ä»¶ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œå½“æˆ‘ä»¬ `source ~/.zshrc`çš„æ—¶å€™ï¼Œé…ç½®ä¼šç«‹å³ç”Ÿæ•ˆï¼Œæ˜¯å› ä¸ºå°±æ˜¯åœ¨å½“å‰è¿›ç¨‹è¿è¡Œçš„ï¼**æ³¨æ„ï¼Œsource æ‰§è¡Œæ—¶ï¼Œè„šæœ¬æ–‡ä»¶æŒ‡å®šè„šæœ¬è§£é‡Šå™¨çš„å‘½ä»¤æ˜¯æ— æ•ˆçš„ï¼Œé»˜è®¤ä½¿ç”¨å½“å‰ shellã€‚**

> â“source shell_script.sh æœ‰ä¸ªç®€å†™ï¼š
>
> . shell_script.sh
>
> ä½†æ˜¯æˆ‘è¿™è¾¹ä¸èƒ½è¿™æ ·è°ƒç”¨ï¼Œä¸çŸ¥é“ä¸ºå•¥ã€‚
>
> å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š . ./shell_script.sh

Exampleï¼šè¯æ˜æ˜¯å¦åˆ›å»ºæ–°è¿›ç¨‹

```shell
# test.sh
#!/usr/bin/env bash
echo "test"
echo $$  # è¾“å‡ºå½“å‰è¿›ç¨‹PID
```

![example](https://happytsing-figure-bed.oss-cn-hangzhou.aliyuncs.com/shell/example.png)

å¦‚å›¾æ‰€ç¤ºï¼šå½“å‰è¿›ç¨‹ PID=356020 ï¼Œåœ¨è¿è¡Œ bash test.sh æ—¶çš„ PID=379044 ï¼Œè¯´æ˜æ˜¯åœ¨æ–°è¿›ç¨‹ä¸‹è¿è¡Œçš„ï¼Œè€Œè¿è¡Œ source test.sh æ—¶ï¼Œ PID=356020 å¹¶æœªå‘ç”Ÿå˜åŒ–ï¼Œè¯´æ˜æ˜¯åœ¨å½“å‰è¿›ç¨‹ä¸‹è¿è¡Œçš„ã€‚

# å››ã€åŸºç¡€çŸ¥è¯†

- å–ç”¨å˜é‡ï¼š `$var`ã€ `${var}`ï¼Œä¾‹å¦‚å¼•ç”¨ç¯å¢ƒå˜é‡ï¼š$PATH
- åˆ é™¤å˜é‡ï¼š `unset var`
- è·å–å­—ç¬¦ä¸²/æ•°ç»„é•¿åº¦ï¼š `${#string}`ã€ `${#array[*]}`

# äº”ã€è¿ç®—ç¬¦

[SHELLï¼šè¿ç®—ç¬¦](https://blog.leqing.work/2022/12/22/shell-operator/)

# å…­ã€å­—ç¬¦ä¸²

shell å­—ç¬¦ä¸²å¯ä»¥ç”¨å•å¼•å· Â `''`ï¼Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å· Â `â€œâ€`ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·ã€‚**æ¨èä½¿ç”¨åŒå¼•å·**ã€‚

> shell è§„å®š**å•å¼•å·ç¦æ­¢å˜é‡æ›¿æ¢**ï¼Œå…ƒå­—ç¬¦$å’Œ\*ç­‰ä¿æŒå…¶ç¬¦å·æœ¬èº«ï¼Œè€ŒåŒå¼•å·å…è®¸å…ƒå­—ç¬¦å˜é‡æ›¿æ¢ã€‚

```bash
str="this is a string"

# æ‹¼æ¥å­—ç¬¦ä¸²
str1="world"
str2="hello, "${str1}""

# è·å–å­—ç¬¦ä¸²é•¿åº¦
echo ${#str}

# æˆªå–å­—ç¬¦ä¸²
echo ${str:2:2}
# Ooutputï¼šisï¼Œä»ä¸‹æ ‡2å¼€å§‹ï¼Œå–2ä¸ªå­—ç¬¦ã€‚

# æŸ¥æ‰¾å­å­—ç¬¦ä¸²
text="hello"
echo `expr index "${text}" ll`

# Outputï¼š3ï¼ŒæŸ¥æ‰¾ ll å­å­—ç¬¦åœ¨ hello å­—ç¬¦ä¸²ä¸­çš„èµ·å§‹ä½ç½®ã€‚
```

# ä¸ƒã€æ•°ç»„

bash åªæ”¯æŒä¸€ç»´æ•°ç»„ï¼Œæ•°ç»„ä¸‹æ ‡ä» 0 å¼€å§‹ã€‚

ä½†æ˜¯[zsh çš„æ•°ç»„ä¸‹æ ‡æ˜¯ä» 1 å¼€å§‹çš„](https://unix.stackexchange.com/questions/252368/is-there-a-reason-why-the-first-element-of-a-zsh-array-is-indexed-by-1-instead-o)ï¼Œå¤§éƒ¨åˆ† shell çš„æ•°ç»„ä¸‹æ ‡éƒ½æ˜¯ä» 1 å¼€å§‹(e.g. Bourne, csh, tcsh, fish, rc, es, yash)ï¼Œé™¤äº† kshï¼Œç”±äº bash æ˜¯åŸºäº ksh çš„ï¼Œå› æ­¤å®ƒä¹Ÿæ˜¯ä» 0 å¼€å§‹çš„ã€‚

[Shellï¼šzsh bash source ./æ‰§è¡Œè„šæœ¬çš„åŒºåˆ«](https://blog.leqing.work/2022/12/22/shell-run-script/)

```bash
# åˆ›å»ºæ•°ç»„çš„ä¸åŒæ–¹å¼
nums=([2]="dark blue" [0]=red [1]=yellow)
nums=(red yellow "dark blue")

# è®¿é—®æ•°ç»„çš„ä¸åŒæ–¹å¼
echo ${nums[1]}

# è®¿é—®æ•°ç»„çš„æ‰€æœ‰å…ƒç´ 
echo ${nums[*]}
echo ${nums[@]}

# è®¿é—®æ•°ç»„çš„éƒ¨åˆ†å…ƒç´ ï¼šä¾‹å¦‚å–å‡ºæ•°ç»„ä¸­ä¸‹æ ‡1å¼€å§‹ï¼Œé•¿åº¦ä¸º2çš„å…ƒç´ ï¼ˆå³å–ä¸¤ä¸ªå…ƒç´ ï¼‰
echo ${nums[*]:1:2}

# è®¿é—®æ•°ç»„é•¿åº¦
echo ${#nums[*]}

# åˆ é™¤æ•°ç»„å…ƒç´ ï¼Œå¦‚ä¸‹åˆ é™¤æ•°ç»„ä¸‹æ ‡0çš„å…ƒç´ ï¼Œæ³¨æ„åˆ é™¤åï¼Œnums[0]=nullï¼Œnums[1]ç­‰ä¸å˜
unset nums[0]
```

# å…«ã€æ§åˆ¶è¯­å¥

> â— æœ¬æ–‡ä¸­éƒ½é‡‡ç”¨ `[]` æ ¼å¼ï¼Œè€Œä¸æ˜¯ `[[]]` æ ¼å¼ã€‚

## 8.1 æ¡ä»¶è¯­å¥

Bash ä¸­çš„æ¡ä»¶è¯­å¥è®©æˆ‘ä»¬å¯ä»¥å†³å®šä¸€ä¸ªæ“ä½œæ˜¯å¦è¢«æ‰§è¡Œã€‚ç»“æœå–å†³äºä¸€ä¸ªåŒ…åœ¨`[[ ]]` æˆ– `[]` é‡Œçš„è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼è¢«ç§°ä¸º `æ£€æµ‹å‘½ä»¤` æˆ– `åŸºå…ƒ` ï¼Œè¿™äº›è¡¨è¾¾å¼çš„ç»“æœæ˜¯ `true|false` ã€‚

[Shellï¼šå•ä¸­æ‹¬å·å’ŒåŒä¸­æ‹¬å·çš„åŒºåˆ«](https://blog.leqing.work/2022/12/23/shell-difference-bracket/)

**æ³¨æ„ï¼šæ¡ä»¶è¡¨è¾¾å¼è¦æ”¾åœ¨æ–¹æ‹¬å·ä¹‹é—´ï¼Œå¹¶ä¸”è¦æœ‰ç©ºæ ¼ã€‚**

ä¾‹å¦‚ï¼š `[$a==$b]`Â  æ˜¯é”™è¯¯çš„ï¼Œå¿…é¡»å†™æˆ Â `[ $a == $b ]`

### if

```bash
if [ condition ]
then
    command1
    ...
    commandN
elif [ condition ]
		command1
		...
		commandN
else
		command1
		...
		commandN
fi

# å†™æˆä¸€è¡Œï¼ˆé€‚ç”¨äºç»ˆç«¯å‘½ä»¤æç¤ºç¬¦ï¼‰ï¼š
if [ condition ]; then command1;commandN; fi
if [ $(ps -ef | grep -c "ssh") -gt 1 ]; then echo "true"; fi
```

### case

å¦‚æœä½ éœ€è¦é¢å¯¹å¾ˆå¤šæƒ…å†µï¼Œåˆ†åˆ«è¦é‡‡å–ä¸åŒçš„æªæ–½ï¼Œé‚£ä¹ˆä½¿ç”¨ `case` ä¼šæ¯”åµŒå¥—çš„ `if` æ›´æœ‰ç”¨ã€‚

```bash
case ${value} in
	"value1")
			command1
			...
			commandN
			;;
	"value2")
			command1
			...
			commandN
			;;
	*)
			command1
			...
			commandN
			;;
esac
```

å–å€¼åé¢å¿…é¡»ä¸ºå•è¯ `in` ï¼Œå–å€¼å¯ä»¥ä¸ºå˜é‡æˆ–å¸¸æ•°ï¼Œæ¯ä¸ª case çš„ç»“æŸæ ‡è®°ä¸º `;;` ï¼Œè‹¥æ— ä¸€åŒ¹é…æ¨¡å¼ï¼Œä½¿ç”¨æ˜Ÿå· `*` æ•è·è¯¥å€¼ã€‚

## 8.2 å¾ªç¯è¯­å¥

### for

```bash
# å½¢å¼1
for var in value1 ... valueN
do
		command1
		...
		commandN
done

# å½¢å¼2
for (( i = 0; i < 10; i++ ))
do
		echo $i
done

# å†™æˆä¸€è¡Œ
for var in value1 ... valueN; do command1;commandN done
```

### while

å½“ `condition=true` æ—¶ï¼Œç»§ç»­å¾ªç¯ï¼Œå¦åˆ™é€€å‡ºã€‚

```bash
while [ condition ]
do
  command1
	...
	commandN
done
```

### until

ä¸ `while` ç›¸åï¼Œå½“ `condition=false` æ—¶ï¼Œç»§ç»­å¾ªç¯ï¼Œå¦åˆ™é€€å‡ºã€‚

```bash
until [ condition ]
do
  command1
	...
	commandN
done
```

## 8.3 break å’Œ continue

å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œå•ç‹¬ä½¿ç”¨ï¼š

- `break;` ï¼šé€€å‡ºå¾ªç¯
- `continue;` ï¼šè·³è¿‡æœ¬æ¬¡å¾ªç¯è¿­ä»£

# ä¹ã€å‡½æ•°

## å®šä¹‰åŠè°ƒç”¨

linux shell å¯ä»¥ç”¨æˆ·å®šä¹‰å‡½æ•°ï¼Œç„¶ååœ¨ shell è„šæœ¬ä¸­å¯ä»¥éšä¾¿è°ƒç”¨ï¼Œæ³¨æ„ï¼Œ**è¯·å°†å‡½æ•°æ”¾åœ¨è„šæœ¬æœ€å‰é¢**ï¼Œå¦åˆ™æ— æ³•è°ƒç”¨ï¼

shell ä¸­å‡½æ•°çš„å®šä¹‰æ ¼å¼å¦‚ä¸‹ï¼š

```bash
function func_name(){
		# statements
		return int
}
```

- æ ¼å¼çœç•¥
  - function å­˜åœ¨æ—¶ï¼Œ()å¯ä»¥çœç•¥ï¼š `function func_name{}`
  - function çœç•¥æ—¶ï¼Œ()ä¸å¯çœç•¥ï¼š `fucn_name(){}` ï¼Œ**å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼**
- å‡½æ•°è¿”å›å€¼
  - åªèƒ½è¿”å› 0~255 çš„æ•´å½¢æ•°å­—ï¼Œè¶…è¿‡åˆ™åšé™¤ä½™%ç®—æ³•(e.g. 256â†’1)ã€‚0 è¡¨ç¤ºæ­£ç¡®ï¼Œå…¶ä½™é”™è¯¯ã€‚
  - è‹¥ä¸åŠ  return è¯­å¥ï¼Œshell é»˜è®¤å°†ä»¥æœ€åä¸€æ¡å‘½ä»¤çš„è¿è¡Œç»“æœä½œä¸ºå‡½æ•°è¿”å›å€¼

å‡½æ•°è°ƒç”¨ï¼š

```bash
# ä¸ä¼ é€’å‚æ•°ï¼Œç›´æ¥ç»™å‡ºå‡½æ•°åå³å¯
func_name

# ä¼ é€’å‚æ•°ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ä»¥ç©ºæ ¼åˆ†éš”
func_name param1 param2 ... paramN
```

## ç‰¹æ®Šå‚æ•°

| å‚æ•°å¤„ç†  | è¯´æ˜                                                                                                           |
| --------- | -------------------------------------------------------------------------------------------------------------- |
| $0        | å½“å‰ shell ç¨‹åºçš„åå­—                                                                                          |
| $n(n>10)  | ç¬¬ n ä¸ªå‚æ•°å€¼                                                                                                  |
| $FUNCNAME | å‡½æ•°åç§°ï¼ˆä»…åœ¨å‡½æ•°å†…éƒ¨æœ‰å€¼ï¼‰                                                                                   |
| $#        | ä¼ é€’åˆ°è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ä¸ªæ•°                                                                                     |
| $\*       | åˆ†åˆ«ç”¨åŒå¼•å·å¼•ç”¨æ‰€æœ‰å‚æ•°                                                                                       |
| $@        | ä¸$\*ç›¸åŒï¼Œä½†æ˜¯ä½¿ç”¨æ—¶åŠ å¼•å·ï¼Œå¹¶åœ¨å¼•å·ä¸­è¿”å›æ¯ä¸ªå‚æ•°ã€‚                                                          |
| $?        | æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚0 è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–ä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯ã€‚                                                 |
| $-        | æ˜¾ç¤º Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼Œä¸ set å‘½ä»¤åŠŸèƒ½ç›¸åŒã€‚                                                               |
| $!        | åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å·                                                                                 |
| $$        | å¯¹äºä»»ä½•è„šæœ¬ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œå®ƒå°†åªæœ‰ä¸€ä¸ªâ€œä¸»â€è¿›ç¨‹ IDï¼Œä¸è®ºè°ƒç”¨å¤šå°‘ä¸ªå­ shellï¼Œ$$éƒ½å°†è¿”å›ä¸è¯¥è„šæœ¬å…³è”çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ ID |
| $BASHPID  | bash å½“å‰å®ä¾‹çš„è¿›ç¨‹ ID                                                                                         |

# åã€æµå’Œé‡å®šå‘

ä½¿ç”¨ `æµ`ï¼Œæˆ‘ä»¬èƒ½å°†ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºå‘é€åˆ°å¦ä¸€ä¸ªç¨‹åºæ–‡ä»¶ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬èƒ½æ–¹ä¾¿åœ°è®°å½•æ—¥å¿—ç­‰ã€‚

`ç®¡é“` ç»™äº†æˆ‘ä»¬åˆ›å»ºä¼ é€å¸¦çš„æœºä¼šï¼Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæˆä¸ºå¯èƒ½ã€‚

ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼š

| ä»£ç  | æè¿°ç¬¦ | æè¿°         |
| ---- | ------ | ------------ |
| 0    | stdin  | æ ‡å‡†è¾“å…¥     |
| 1    | stdout | æ ‡å‡†è¾“å‡º     |
| 2    | stderr | æ ‡å‡†é”™è¯¯è¾“å‡º |

é‡å®šå‘ï¼š

- `1>` ä¸ºæ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼Œå¯ä»¥ç¼©å†™ä¸º `>`
- åŒç†ï¼Œ `2>` ä¸ºæ ‡å‡†é”™è¯¯é‡å®šå‘
- `>>` å’Œ `>` çš„åŒºåˆ«åœ¨äºï¼Œ`>>` æ˜¯åœ¨æ–‡ä»¶åè¿½åŠ ï¼Œè€Œ `>` ä¼šè¦†ç›–åŸå†…å®¹

```bash
# 1. ä»€ä¹ˆæ˜¯æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯ï¼Ÿ
$ ls
a.txt

$ ls a.txt b.txt
ls: cannot access 'b.txt': No such file or directory # æ ‡å‡†é”™è¯¯
a.txt # æ ‡å‡†è¾“å‡º

# 2. é‡å®šå‘
$ ls a.txt b.txt 1>file.out 2>file.error # æ‰§è¡Œåæ²¡æœ‰è¾“å‡ºï¼Œåˆ›å»ºäº†ä¸¤ä¸ªæ–‡ä»¶

$ cat file.out
a.txt

$ cat file.error
ls: cannot access 'b.txt': No such file or directory
```

ç†è§£æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯å’Œé‡å®šå‘ä¹‹åï¼Œè¿›ä¸€æ­¥æ·±å…¥ï¼š

- `2>&1` å°† `æ ‡å‡†é”™è¯¯` é‡å®šå‘åˆ° `æ ‡å‡†è¾“å‡º`ï¼Œå¯ä»¥ç†è§£ä¸ºåˆå¹¶ï¼
- åŒç†ï¼Œ `1>&2` å°† `æ ‡å‡†è¾“å‡º` é‡å®šå‘åˆ° `æ ‡å‡†é”™è¯¯`
- `&>` å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯åŒæ—¶é‡å®šå‘ï¼Œ `&>file_name` è¡¨ç¤ºåŒæ—¶é‡å®šå‘åˆ°æ–‡ä»¶ï¼Œç­‰åŒäºï¼š `1>file_name 2>&1` æˆ– `2>file_name 1>&2`
- æ³¨æ„ï¼Œä¸ºä»€ä¹ˆå¿…é¡»æ·»åŠ  `&` ç¬¦å·å‘¢ï¼Œå› ä¸º `2>1` æ—¶ï¼Œä¼šæŠŠæ ‡å‡†é”™è¯¯è¾“å‡ºåˆ°æ–‡ä»¶åä¸º 1 çš„æ–‡ä»¶ä¸­ï¼

è¾“å‡ºä¸ä»…ä»…åªæœ‰æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ä¸¤ç§ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–ç±»å‹ï¼Œæ¯”å¦‚ï¼š

- `/dev/null` æ–‡ä»¶æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå†™å…¥åˆ°å®ƒçš„å†…å®¹éƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œä¹Ÿæ— æ³•ä»ä¸­è¯»å–å†…å®¹ã€‚å…¶ä¸»è¦ç”¨å¤„æ˜¯ `ç¦æ­¢è¾“å‡º` ã€‚

# åä¸€ã€Debug

shell æä¾›äº†ä¸€äº›ç”¨äºè°ƒè¯•è„šæœ¬çš„é€‰é¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

| Short | Name        | Description                                                |
| ----- | ----------- | ---------------------------------------------------------- |
| -f    | noglob      | ç¦æ­¢æ¨¡å¼æ‰©å±•ï¼ˆglobbingï¼‰ï¼Œå¦‚~ä¼šè‡ªåŠ¨æ‰©å±•ä¸ºå®¶ç›®å½•            |
| -i    | interactive | è®©è„šæœ¬ä»¥ Â  äº¤äº’ Â  æ¨¡å¼è¿è¡Œ                                 |
| -x    | xtrace      | åœ¨æ‰§è¡Œæ¯æ¡å‘½ä»¤å‰ï¼Œå‘ stderr è¾“å‡ºè¯¥å‘½ä»¤ä»¥åŠè¯¥å‘½ä»¤çš„æ‰©å±•å‚æ•° |
| -v    | verbose     | åœ¨æ‰§è¡Œæ¯æ¡å‘½ä»¤å‰ï¼Œå‘ stderr è¾“å‡ºè¯¥å‘½ä»¤                     |
| -t    | â€”           | æ‰§è¡Œå®Œç¬¬ä¸€æ¡å‘½ä»¤åé€€å‡º                                     |
| -n    | noexec      | è¯»å–å‘½ä»¤ï¼Œä½†ä¸æ‰§è¡Œï¼ˆè¯­æ³•æ£€æŸ¥ï¼‰                             |

ä½¿ç”¨è¿™äº›é€‰é¡¹æœ‰ä¸‰ç§æ–¹æ³•ï¼š

- å‘½ä»¤è¡Œæä¾›å‚æ•°ï¼š `$ sh -x ./shell_script.sh`
- è„šæœ¬å¼€å¤´æä¾›å‚æ•°ï¼š `#! /usr/bin/env bash -x`
- åœ¨è„šæœ¬ä¸­ç”¨ set å‘½ä»¤å¯ç”¨æˆ–ç¦ç”¨å‚æ•°ï¼š

```bash
#! /usr/bin/env bash
if [ -z "$1" ]; then
  set -x
  echo "ERROR: Insufficient Args."
  exit 1
  set +x
fi
```

# åäºŒã€å‘½ä»¤

- echo
- printf
- grep
- test
- cat

# Reference

- [åšå®¢å›­ | ä¸€æ–‡æŒæ¡ shell è¯­è¨€](https://www.cnblogs.com/jingmoxukong/p/7867397.html)
- [C è¯­è¨€ä¸­æ–‡ç½‘ | Shell æ•™ç¨‹](http://c.biancheng.net/cpp/view/6994.html)
- [å»–é›ªå³° | Bash è„šæœ¬æ•™ç¨‹](https://wangdoc.com/bash/expansion.html#%E7%AE%80%E4%BB%8B)
- [bash-handbook-zh-CN](https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#%E5%A4%A7%E6%8B%AC%E5%8F%B7%E6%89%A9%E5%B1%95)
- [Linux Tools Quick Tutorial](https://linuxtools-rst.readthedocs.io/zh_CN/latest/base/index.html#)
- [Shellï¼šè¿ç®—ç¬¦](https://blog.leqing.work/2022/12/22/shell-operator/)
- [Shellï¼šzsh bash source ./æ‰§è¡Œè„šæœ¬çš„åŒºåˆ«](https://blog.leqing.work/2022/12/22/shell-run-script/)
- [Shellï¼šå•ä¸­æ‹¬å·å’ŒåŒä¸­æ‹¬å·çš„åŒºåˆ«](https://blog.leqing.work/2022/12/23/shell-difference-bracket/)
